version: 0.1
component: build
timeoutInSeconds: 1000

steps:
steps:
  - name: Debug Environment Variables
    run: |
      echo "REGION=${OCI_REGION}"
      echo "NAMESPACE=${NAMESPACE}"
      echo "IMAGE_TAG=${IMAGE_TAG}"

  - name: Build Docker Image
    run: |
      docker build -t ${REGION}.ocir.io/${NAMESPACE}/tg_bot:${IMAGE_TAG} .

  - name: Login to OCI Container Registry
    run: |
      echo '${PASSWORD}' | docker login -u '${USER}' --password-stdin ${REGION}.ocir.io

  - name: Push Docker Image to OCI
    run: |
      docker push ${REGION}.ocir.io/${NAMESPACE}/tg_bot:${IMAGE_TAG}